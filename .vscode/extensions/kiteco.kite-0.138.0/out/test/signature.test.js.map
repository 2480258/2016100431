{"version":3,"sources":["../external \"path\"","../external \"vscode\"","../external \"chai\"","../external \"kite-api\"","../external \"fs\"","../external \"kite-api/test/helpers/kite\"","../external \"kite-api/test/helpers/http\"",".././test/helpers.js",".././src/utils.js","../external \"child_process\"","../external \"os\"","../external \"kite-connector/lib/logger\"",".././src/urls.js","../external \"md5\"",".././src/data-utils.js",".././test/signature.test.js",".././src/signature.js","../webpack/bootstrap","../webpack/runtime/compat get default export","../webpack/runtime/define property getters","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/make namespace object","../webpack/startup"],"names":[],"mappings":";;;;;;;;AAAA,kC;;;;;;;;;;;;;ACAA,oC;;;;;;;ACAA,kC;;;;;;;;ACAA,sC;;;;;;;;;;ACAA,gC;;;;;;;ACAA,wD;;;;;;;ACAA,wD;;;;;;;ACAa;;AAEb,aAAa,mBAAO,CAAC,CAAM;AAC3B,gBAAgB,mBAAO,CAAC,EAAU;AAClC,OAAO,wBAAwB,GAAG,mBAAO,CAAC,EAAc;;AAExD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,wBAAwB,gBAAgB,SAAS,IAAI;AACrD,OAAO;AACP,wBAAwB,gBAAgB,SAAS,EAAE;AACnD;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA,qBAAqB,SAAS;AAC9B;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,qBAAqB,wBAAwB;AAC7C,YAAY,OAAO,GAAG,KAAK,GAAG,cAAc;AAC5C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9Fa;;AAEe;AACG;AACX;;AAEW;;AAE/B;AACA,SAAS,uDAAe;AACxB;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,yBAAyB,0BAA0B;AACnD;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sBAAsB,aAAa;AACnC,sBAAsB,aAAa;AACnC;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE,8EAAuC;;AAEzC;AACA;AACA;AACA;AACA;AACA,GAAG,IAAI;AACP;;AAEA;AACA,KAAK,uDAAc;AACnB,kDAAkD;AAClD;AACA,MAAM,kDAAW;AACjB;AACA;AACA;AACA;;AAEA;AACA,8BAA8B;AAC9B;AACA,SAAS,kDAAW;AACpB;AACA,MAAM,8DAAY,iBAAiB,WAAW;AAC9C;AACA;AACA,MAAM,8DAAY,wCAAwC,WAAW;AACrE;AACA;AACA,MAAM,8DAAY,qBAAqB,WAAW;AAClD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AA8BE;;;;;;;;AC9NF,2C;;;;;;;ACAA,gC;;;;;;;;ACAA,uD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAa;AACe;AACN;;AAES;;AAE/B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB,sCAAsC;AACtD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,gBAAgB,OAAO;AACvB,eAAe,MAAM;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB,sCAAsC;AACtD;AACA;;AAEA;AACA;AACA;AACA,gBAAgB,sCAAsC;AACtD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB,4CAAI;;AAErB;AACA;;AAEA;AA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","file":"signature.test.js","sourcesContent":["module.exports = require(\"path\");;","module.exports = require(\"vscode\");;","module.exports = require(\"chai\");;","module.exports = require(\"kite-api\");;","module.exports = require(\"fs\");;","module.exports = require(\"kite-api/test/helpers/kite\");;","module.exports = require(\"kite-api/test/helpers/http\");;","\"use strict\";\n\nconst path = require(\"path\");\nconst KiteAPI = require(\"kite-api\");\nconst { promisifyReadResponse } = require(\"../src/utils\");\n\nconst Kite = {\n  request(req, data) {\n    return KiteAPI.request(req, data).then(resp => promisifyReadResponse(resp));\n  }\n};\n\nfunction waitsFor(m, f, t, i) {\n  if (typeof m == \"function\" && typeof f != \"function\") {\n    i = t;\n    t = f;\n    f = m;\n    m = \"something to happen\";\n  }\n\n  const intervalTime = i || 10;\n  const timeoutDuration = t || 2000;\n\n  return new Promise((resolve, reject) => {\n    const interval = setInterval(() => {\n      const res = f();\n      if (res) {\n        if (res.then) {\n          res.then(\n            () => {\n              clearTimeout(timeout);\n              clearInterval(interval);\n              resolve();\n            },\n            err => {}\n          );\n        } else {\n          clearTimeout(timeout);\n          clearInterval(interval);\n          resolve();\n        }\n      }\n    }, intervalTime);\n\n    const timeout = setTimeout(() => {\n      clearInterval(interval);\n      let msg;\n      if (typeof m == \"function\") {\n        msg = `Waited ${timeoutDuration}ms for ${m()}`;\n      } else {\n        msg = `Waited ${timeoutDuration}ms for ${m} but nothing happened`;\n      }\n      reject(new Error(msg));\n    }, timeoutDuration);\n  });\n}\n\nfunction sleep(duration) {\n  const t = new Date();\n  return waitsFor(`${duration}ms`, () => {\n    return new Date() - t > duration;\n  });\n}\n\nfunction delay(duration, block) {\n  return new Promise(resolve => {\n    setTimeout(() => {\n      block();\n      resolve();\n    }, duration);\n  });\n}\n\nfunction fixtureURI(filepath) {\n  return path.resolve(__dirname, \"fixtures\", filepath);\n}\n\nfunction log(v) {\n  console.log(v);\n  return v;\n}\n\nfunction formatCall({ method, path, payload }) {\n  return `${method} ${path} ${payload || \"\"}`;\n}\n\nmodule.exports = {\n  sleep,\n  delay,\n  fixtureURI,\n  waitsFor,\n  Kite,\n  log,\n  formatCall\n};\n","'use strict';\n\nimport vscode from 'vscode';\nimport cp from 'child_process';\nimport os from 'os';\n\nimport KiteAPI from \"kite-api\";\n\nfunction promisifiedKiteAPIRequest(req, data) {\n  return KiteAPI.request(req, data).then(resp => promisifyReadResponse(resp));\n};\n\nconst compact = a => a.filter(v => v && v !== '');\n\nconst uniq = a => a.reduce((m, v) => m.indexOf(v) === -1 ? m.concat(v) : m, []);\n\nconst flatten = a =>\n  a.reduce((m, o) => m.concat(Array.isArray(o) ? flatten(o) : o), []);\n\nconst head = a => a[0];\nconst last = a => a[a.length - 1];\nconst log = v => (console.log(v), v);\n\nconst evalPath = (o, ...path) =>\n  path.reduce((m, k) => {\n    if (k === '*' && m) { k = head(Object.keys(m)); }\n    return m && typeof m[k] !== 'undefined' ? m[k] : undefined;\n  }, o);\n\nconst detailLang = o =>\n  o && o.language_details\n    ? head(Object.keys(o.language_details)).toLowerCase()\n    : 'python';\n\nconst detailGet = (o, ...k) => evalPath(o, 'language_details', '*', ...k);\n\nconst detailExist = (o, ...k) => detailGet(o, ...k) != null;\n\nconst detailNotEmpty = (o, ...k) => {\n  const v = detailGet(o, ...k);\n  return v != null && v.length > 0;\n};\n\nconst getDetails = (o, ...details) =>\n  o.detail || (o.details && details.reduce((m, k) => {\n    return m || o.details[k];\n  }, null));\n\nconst getFunctionDetails = (o) => {\n  const type = head(Object.keys(o.details).filter(k => o.details[k]));\n  if (type === 'function') {\n    return o.details.function;\n  } else if (type === 'type') {\n    return detailGet(o.details.type, 'constructor');\n  }\n\n  return null;\n};\n\nconst merge = (a, b) => {\n  const c = {};\n  for (const k in a) { c[k] = a[k]; }\n  for (const k in b) { c[k] = b[k]; }\n  return c;\n};\n\nconst stripTags = s => s.replace(/<[^>]+>/g, '');\n\nconst truncate = (s, l = 200) =>\n  s && s.length > l\n    ? s.slice(0, l) + '…'\n    : s;\n\nfunction parseJSON(data, fallback) {\n  try {\n    return JSON.parse(data);\n  } catch (e) {\n    return fallback;\n  }\n}\n\n// get time in seconds since the date\nfunction secondsSince(when) {\n  var now = new Date();\n  return (now.getTime() - when.getTime()) / 1000.0;\n}\n\nfunction promisifyRequest(request) {\n  return request.then\n    ? request\n    : new Promise((resolve, reject) => {\n      request.on('response', resp => resolve(resp));\n      request.on('error', err => reject(err));\n    });\n}\n\nfunction promisifyReadResponse(response) {\n  return new Promise((resolve, reject) => {\n    let data = '';\n    response.on('data', chunk => data += chunk);\n    response.on('end', () => resolve(data));\n    response.on('error', err => reject(err));\n  });\n}\n\nfunction delayPromise(factory, timeout) {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      factory().then(resolve, reject);\n    }, timeout);\n  });\n}\n\nconst stopPropagationAndDefault = f => function(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  return f && f.call(this, e);\n};\n\nconst editorsForDocument = document =>\n  vscode.window.visibleTextEditors.filter(e => e.document === document);\n\nfunction params (url) {\n  return url.query.split('&').reduce((m, p) => {\n    const [k,v] = p.split('=');\n    m[k] = v;\n    return m;\n  }, {});\n}\n\nconst escapeCommandArguments = (o) => {\n  if(vscode.version < \"1.30.0\") {\n    return JSON.stringify(o).replace(/\"/g, '&quot;');\n  }\n  if (os.platform() == 'win32') {\n    return JSON.stringify(o).replace(/\\\\\\\\/g, \"/\");\n  }\n  return JSON.stringify(o);\n};\n\nconst kiteOpen = (url) => {\n  const env = Object.assign({}, process.env);\n  delete env[\"ELECTRON_RUN_AS_NODE\"];\n  switch(os.platform()) {\n    case 'darwin':\n      cp.spawnSync(\"open\", [url], { env: env });\n      break;\n    case 'win32':\n      cp.spawnSync(\"cmd\", [\"/b\", \"/c\", \"start\",\"\", url], { env: env });\n      break;\n    case 'linux':\n      cp.spawnSync(\"xdg-open\", [url], { env: env });\n  }\n};\n\nconst extToLangMap = new Map([\n  [\"c\", \"c\"],\n  [\"cc\",\"cpp\"],\n  [\"cpp\",\"cpp\"],\n  [\"cs\",\"csharp\"],\n  [\"css\",\"css\"],\n  [\"go\",\"go\"],\n  [\"h\",\"c\"],\n  [\"hpp\",\"cpp\"],\n  [\"html\",\"html\"],\n  [\"java\", \"java\"],\n  [\"js\", \"javascript\"],\n  [\"jsx\",\"jsx\"],\n  [\"kt\",\"kotlin\"],\n  [\"less\",\"less\"],\n  [\"m\",\"objectivec\"],\n  [\"php\", \"php\"],\n  [\"py\", \"python\"],\n  [\"pyw\", \"python\"],\n  [\"rb\",\"ruby\"],\n  [\"scala\",\"scala\"],\n  [\"sh\",\"bash\"],\n  [\"ts\",\"typescript\"],\n  [\"tsx\",\"tsx\"],\n  [\"vue\",\"vue\"],\n]);\n\nconst getSupportedLanguage = document => {\n  if (document.isUntitled) {\n    return null;\n  }\n\n  const ext = document.fileName.split(\".\").slice(-1)[0];\n  if (extToLangMap.has(ext)) {\n    return extToLangMap.get(ext);\n  }\n  return null;\n};\n\nexport {\n  compact,\n  delayPromise,\n  flatten,\n  head,\n  last,\n  log,\n  escapeCommandArguments,\n  detailExist,\n  detailGet,\n  detailLang,\n  detailNotEmpty,\n  parseJSON,\n  promisifyReadResponse,\n  promisifyRequest,\n  secondsSince,\n  promisifiedKiteAPIRequest,\n  stopPropagationAndDefault,\n  truncate,\n  uniq,\n  stripTags,\n  editorsForDocument,\n  params,\n  merge,\n  getDetails,\n  getFunctionDetails,\n  kiteOpen,\n  getSupportedLanguage,\n};\n","module.exports = require(\"child_process\");;","module.exports = require(\"os\");;","module.exports = require(\"kite-connector/lib/logger\");;","'use strict';\nimport vscode from 'vscode';\nimport md5 from 'md5';\n\nimport { head } from './utils';\n\nfunction metricsCounterPath() {\n  return '/clientapi/metrics/counters';\n}\n\nfunction metricsCompletionSelectedPath() {\n  return '/clientapi/metrics/completions/selected';\n}\n\nfunction languagesPath() {\n  return '/clientapi/languages';\n}\n\nfunction accountPath() {\n  return '/api/account/user';\n}\n\nfunction statusPath(path) {\n  return [\n    '/clientapi/status',\n    `filename=${encodeURI(normalizeDriveLetter(path))}`,\n  ].join('?');\n}\n\nfunction signaturePath() {\n  return '/clientapi/editor/signatures';\n}\n\nfunction searchPath(query, offset = 0, limit = 10) {\n  return [\n    '/api/editor/search',\n    [\n      `q=${encodeURI(query)}`,\n      `offset=${offset}`,\n      `limit=${limit}`,\n    ].join('&'),\n  ].join('?');\n}\n\nfunction projectDirPath(path) {\n  return [\n    '/clientapi/projectdir',\n    `filename=${encodeURI(normalizeDriveLetter(path))}`,\n  ].join('?');\n}\n\nfunction shouldNotifyPath(path) {\n  return [\n    '/clientapi/permissions/notify',\n    `filename=${encodeURI(normalizeDriveLetter(path))}`,\n  ].join('?');\n}\n\nfunction settingsPath(key) {\n  return '/clientapi/settings/' + key;\n}\n\nfunction completionsPath() {\n  return '/clientapi/editor/complete';\n}\n\nfunction reportPath(data) {\n  const symbol = head(data.symbol);\n\n  return valueReportPath(symbol.id);\n}\n\nfunction valueReportPath(id) {\n  return `/api/editor/value/${id}`;\n}\n\nfunction symbolReportPath(id) {\n  return `/api/editor/symbol/${id}`;\n}\n\nfunction membersPath(id, page = 0, limit = 999) {\n  return [\n    `/api/editor/value/${id}/members`,\n    [\n      `offset=${page}`,\n      `limit=${limit}`,\n    ].join('&'),\n  ].join('?');\n}\n\nfunction usagesPath(id, page = 0, limit = 999) {\n  return [\n    `/api/editor/value/${id}/usages`,\n    [\n      `offset=${page}`,\n      `limit=${limit}`,\n    ].join('&'),\n  ].join('?');\n}\n\nfunction usagePath(id) {\n  return `/api/editor/usages/${id}`;\n}\n\nfunction examplePath(id) {\n  return `/api/python/curation/${id}`;\n}\n\nfunction openDocumentationInWebURL(id) {\n  const url = `http://localhost:46624/clientapi/desktoplogin?d=/docs/${escapeId(id)}`;\n  return url;\n}\n\nfunction openSignatureInWebURL(id) {\n  const url = `http://localhost:46624/clientapi/desktoplogin?d=/docs/${escapeId(id)}%23signature`;\n  return url;\n}\n\nfunction openExampleInWebURL(id) {\n  const url = `http://localhost:46624/clientapi/desktoplogin?d=/examples/python/${escapeId(id)}`;\n  return url;\n}\n\nfunction hoverPath(document, position) {\n  position = new vscode.Position(position.line, position.character);\n  const state = md5(document.getText());\n  const filename = document.fileName;\n  const buffer = cleanPath(filename);\n  const pos = document.offsetAt(position);\n  const encoding = 'utf-16';\n  return [\n    `/api/buffer/vscode/${buffer}/${state}/hover`,\n    [\n      `cursor_runes=${pos}`,\n      `offset_encoding=${encoding}`,\n    ].join('&'),\n  ].join('?');\n}\n\nfunction escapeId(id) {\n  return encodeURI(String(id)).replace(/;/g, '%3B');\n}\n\nfunction cleanPath(p) {\n  return encodeURI(normalizeDriveLetter(p))\n    .replace(/^([a-zA-Z]):/, (m, d) => `/windows/${d}`)\n    .replace(/\\/|\\\\|%5C/g, ':');\n}\n\nfunction serializeRangeForPath(range) {\n  return `${range.start.row}:${range.start.column}/${range.end.row}:${range.end.column}`;\n}\n\nfunction normalizeDriveLetter(str) {\n  return str.replace(/^[a-z]:/, m => m.toUpperCase());\n}\n\nexport {\n  accountPath,\n  completionsPath,\n  examplePath,\n  hoverPath,\n  languagesPath,\n  membersPath,\n  metricsCounterPath,\n  metricsCompletionSelectedPath,\n  normalizeDriveLetter,\n  openDocumentationInWebURL,\n  openExampleInWebURL,\n  openSignatureInWebURL,\n  projectDirPath,\n  reportPath,\n  searchPath,\n  serializeRangeForPath,\n  shouldNotifyPath,\n  settingsPath,\n  signaturePath,\n  statusPath,\n  symbolReportPath,\n  usagePath,\n  usagesPath,\n  valueReportPath,\n};\n","module.exports = require(\"md5\");;","'use strict';\n\nimport { compact, flatten, head, last, uniq, detailGet, detailLang, detailNotEmpty, getFunctionDetails } from './utils';\n\nconst idIsEmpty = (id) =>\n  !id || id === '' ||\n  (id.indexOf(';') !== -1 && id.split(';')[1] === '');\n\nconst isFunctionKind = kind => ['function', 'type'].includes(kind);\n\nconst parameterName = (p, prefix = '', w) =>\n  p\n    ? (\n      w\n        ? `<${w}>${prefix}<span class=\"parameter-name\">${p.name}</span></${head(w.split(/\\s/g))}>`\n        : `${prefix}<span class=\"parameter-name\">${p.name}</span>`\n    )\n    : undefined;\n\nconst parameterDefault = (p) => {\n  if (!p) { return ''; }\n\n  const lang = detailLang(p);\n\n  switch (lang) {\n    case 'python':\n    case 'javascript':\n      return detailNotEmpty(p, 'default_value')\n        ? `=${head(detailGet(p, 'default_value')).repr}`\n        : '';\n    default:\n      return '';\n  }\n};\n\nconst parameterType = (p, prefix = '') =>\n  p.inferred_value && p.inferred_value\n    ? `${prefix}${uniq(compact(p.inferred_value).map(v =>\n      `<a href='command:kite.navigate?\"value/${v.type_id}\"' class=\"parameter-type\">${v.type}</a>`)).join('<i>|</i>')}`\n    : '';\n\nconst parameterTypeLink = parameterType;\n\nconst parameterValue = p =>\n  `${parameterName(p)}${parameterType(p, ':')}${parameterDefault(p)}`;\n\nconst parameters = (d, withType = true) =>\n  d.parameters\n    ? (withType\n      ? d.parameters.map(parameterValue)\n      : d.parameters.map(p => `${parameterName(p)}${parameterDefault(p)}`))\n    : [];\n\nconst gatherParameters = (detail, withType) => {\n  const lang = detailLang(detail);\n  switch (lang) {\n    case 'python':\n      return [\n        parameters(detail, withType),\n        parameterName(detailGet(detail, 'vararg'), '*'),\n        parameterName(detailGet(detail, 'kwarg'), '**'),\n      ];\n    case 'javascript':\n      return [\n        parameters(detail, withType),\n        parameterName(detailGet(detail, 'rest'), '…'),\n      ];\n    default:\n      return [\n        parameters(detail, withType),\n      ];\n  }\n};\n\nconst signature = (data, withType = true, current = -1) => {\n  const detail = getFunctionDetails(data);\n  return detail\n    ? `(<span class=\"signature\">${\n      compact(flatten(gatherParameters(detail, withType)))\n        .map((p, i, a) => {\n          const s = i === a.length - 1 ? '' : ', ';\n          return i === current\n            ? `<span class=\"parameter parameter-highlight\">${p}${s}</span>`\n            : `<span class=\"parameter\">${p}${s}</span>`;\n        })\n        .join('')\n    }</span>)`\n    : '(<span class=\"signature\"></span>)';\n};\n\nconst callParameterName = (parameter) => parameter.name;\n\nconst callKwargParameter = (parameter) => {\n  const example = head(parameter.types.filter(t => t.examples));\n  return example\n    ? compact([\n      callParameterName(parameter),\n      head(example.examples).replace(/\"'/g, \"'\").replace(/'\"/g, \"'\"),\n    ]).join('=')\n    : callParameterName(parameter);\n};\n\nconst callKwargParameters = (signature) =>\n  detailNotEmpty(signature, 'kwargs')\n    ? detailGet(signature, 'kwargs').map(p => callKwargParameter(p)).join(', ')\n    : null;\n\nconst callSignature = (data) =>\n  compact(flatten([\n    (data.args || []).map(callParameterName),\n    callKwargParameters(data),\n  ]))\n    .join(', ');\n\nconst valueName = value =>\n  last(last(value.repr.replace(/\\(|\\)/g, '').split('|').map(s => s.trim().split(':'))));\n\nconst valueNameFromId = value => last(value.id.split(/[;.]/g));\n\nconst valueLabel = (value, current) => {\n  if (isFunctionKind(value.kind)) {\n    return valueName(value) + signature(value, true, current);\n  } else {\n    return (value.kind === 'instance'\n      ? valueNameFromId(value)\n      : valueName(value));\n  }\n};\n\nconst symbolName = s => {\n  const value = head(s.value);\n  return value.kind === 'instance'\n    ? s.name\n    : valueName(value);\n};\n\nconst symbolLabel = (s, current) => {\n  const value = head(s.value);\n  return isFunctionKind(value.kind)\n    ? symbolName(s) + signature(value, true, current)\n    : symbolName(s);\n};\n\nconst memberLabel = (s) => {\n  const value = s.value ? head(s.value) : {};\n  const name = `<span class=\"repr\">${s.name}</span>`;\n  return isFunctionKind(value.kind) ? name + '()' : name;\n};\n\nconst wrapType = (o) => {\n  const { name, id } = o || {};\n  return name\n    ? (!idIsEmpty(id)\n      ? `<a href='command:kite.navigate?\"value/${id}\"' class=\"type-value\">${name}</a>`\n      : `<span class=\"type-value\">${name}</span>`\n    )\n    : null;\n};\n\nconst unionType = (vs, map) =>\n  uniq(flatten(compact(vs.map(map))).map(wrapType)).join(' | ');\n\nconst returnType = (v) =>\n  v && v.length ? `-> <span class=\"return-type\">${v}</span>` : '';\n\nconst symbolValue = s => head(s.value);\n\nconst symbolKindMarkdown = s => {\n  const value = symbolValue(s);\n  if (value.kind !== 'instance') {\n    return `[ _${value.kind}_ ]`;\n  }\n  let types = uniq(s.value.filter(v => v.kind === 'instance').map(v => `_${v.type.replace('_', '\\\\_')}_`));\n  return `[ ${types.join(' | ')} ]`;\n};\n\nconst reportFromHover = hover => {\n  const symbol = head(hover.symbol);\n  const data = {\n    symbol,\n    report: hover.report,\n  };\n  if (data.value && data.value.id === '') { data.value.id = symbol.name; }\n  return data;\n};\n\nconst extractInstanceType = v => ({ name: v.type, id: v.type_id });\nconst extractFunctionType = v => {\n  const detail = getFunctionDetails(v);\n  return detail && detail.return_value\n    ? detail.return_value.map(v => ({ name: v.type, id: v.type_id }))\n    : [];\n};\n\nconst symbolType = s => unionType(s.value, extractInstanceType);\n\nconst symbolReturnType = s => unionType(s.value, extractFunctionType);\n\nconst valueType = value =>\n  isFunctionKind(value.kind)\n    ? returnType(unionType([value], extractFunctionType))\n    : unionType([value], extractInstanceType);\n\nconst symbolId = (symbol) =>\n  symbol.id !== ''\n    ? symbol.id\n    : head(symbol.value).id;\n\nexport {\n  callSignature,\n  memberLabel,\n  parameterName,\n  parameterType,\n  parameterDefault,\n  parameterValue,\n  parameterTypeLink,\n  reportFromHover,\n  returnType,\n  signature,\n  symbolId,\n  symbolKindMarkdown,\n  symbolLabel,\n  symbolName,\n  symbolType,\n  symbolValue,\n  unionType,\n  valueLabel,\n  valueName,\n  valueNameFromId,\n  valueType,\n  idIsEmpty,\n  isFunctionKind,\n  symbolReturnType,\n};\n","const fs = require('fs');\nconst expect = require('chai').expect;\nconst vscode = require('vscode');\nconst { fixtureURI, Kite } = require('./helpers');\n\nconst { withKite, withKiteRoutes } = require('kite-api/test/helpers/kite');\nconst { fakeResponse } = require('kite-api/test/helpers/http');\n\n\nconst KiteSignatureProvider = require('../src/signature').default;\n\ndescribe('KiteSignatureProvider', () => {\n  let provider;\n\n  beforeEach(() => {\n    provider = new KiteSignatureProvider(Kite, true);\n  });\n  withKite({ reachable: true }, () => {\n    describe('for a python function with a signature', () => {\n      withKiteRoutes([\n        [\n          o => /\\/clientapi\\/editor\\/signatures/.test(o.path),\n          () => fakeResponse(200, fs.readFileSync(fixtureURI('plot-signatures.json').toString()))\n        ]\n      ]);\n\n      it('provides a representation of the function signature', () => {\n        const uri = vscode.Uri.file(fixtureURI('sample.py'));\n\n        return vscode.workspace.openTextDocument(uri)\n        .then(doc => provider.provideSignatureHelp(doc, new vscode.Position(19, 13), null))\n        .then(res => {\n          expect(res.signatures.length).to.equal(1);\n          expect(res.signatures[0].label).to.equal('⟠ plot(x:list|uint64, y:list|str)');\n          expect(res.signatures[0].parameters.length).to.equal(2);\n          expect(res.signatures[0].parameters[0].label).to.equal('x:list|uint64');\n          expect(res.signatures[0].parameters[1].label).to.equal('y:list|str');\n\n          expect(res.activeParameter).to.equal(1);\n          expect(res.activeSignature).to.equal(0);\n        });\n      });\n    });\n\n    describe('for a python function with no signature', () => {\n      withKiteRoutes([\n        [\n          o => /\\/clientapi\\/editor\\/signatures/.test(o.path),\n          () => fakeResponse(404)\n        ]\n      ]);\n\n      it('returns null', () => {\n        const uri = vscode.Uri.file(fixtureURI('sample.py'));\n\n        return vscode.workspace.openTextDocument(uri)\n        .then(doc => provider.provideSignatureHelp(doc, new vscode.Position(19, 13), null))\n        .then(res => {\n          expect(res).to.equal(null);\n        });\n      });\n    });\n  });\n});\n","\"use strict\";\nimport {\n  SignatureHelp,\n  SignatureInformation,\n  ParameterInformation\n} from 'vscode';\n\nimport Logger from \"kite-connector/lib/logger\";\nimport { parseJSON, stripTags, getFunctionDetails } from \"./utils\";\nimport { signaturePath, normalizeDriveLetter } from \"./urls\";\nimport { valueLabel, parameterType } from \"./data-utils\";\n\nexport default class KiteSignatureProvider {\n  constructor(Kite, isTest) {\n    this.Kite = Kite;\n    this.isTest = isTest;\n  }\n\n  provideSignatureHelp(document, position) {\n    const text = document.getText();\n\n    if (text.length > this.Kite.maxFileSize) {\n      Logger.warn(\"buffer contents too large, not attempting signature\");\n      return null;\n    }\n\n    const cursorPosition = document.offsetAt(position);\n    const payload = {\n      text,\n      editor: \"vscode\",\n      filename: normalizeDriveLetter(document.fileName),\n      cursor_runes: cursorPosition,\n      offset_encoding: \"utf-16\"\n    };\n    Logger.debug(payload);\n\n    return this.Kite.request(\n      {\n        path: signaturePath(),\n        method: \"POST\"\n      },\n      JSON.stringify(payload),\n      document\n    )\n      .then(data => {\n        data = parseJSON(data, {});\n\n        const [call] = data.calls;\n\n        const { callee } = call;\n\n        const help = new SignatureHelp();\n        help.activeParameter = call.arg_index;\n        help.activeSignature = 0;\n\n        const label = \"⟠ \" + stripTags(valueLabel(callee));\n        const sig = new SignatureInformation(label);\n        const detail = getFunctionDetails(callee);\n        sig.parameters = (detail.parameters || []).map(p => {\n          const label = p.inferred_value\n            ? `${p.name}:${stripTags(parameterType(p))}`\n            : p.name;\n          const param = new ParameterInformation(label);\n          return param;\n        });\n\n        if (\n          Array.isArray(detail.return_value) &&\n          detail.return_value.length &&\n          detail.return_value[0].type\n        ) {\n          sig.documentation = `Returns → ${detail.return_value[0].type}`;\n        }\n\n        help.signatures = [sig];\n\n        return help;\n      })\n      .catch(() => null);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(41);\n"],"sourceRoot":""}